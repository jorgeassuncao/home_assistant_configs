{"version":3,"sources":["webpack:///./src/components/entity/ha-entity-picker.js","webpack:///./src/panels/dev-state/ha-panel-dev-state.js"],"names":["HaEntityPicker","Object","_mixins_events_mixin_js__WEBPACK_IMPORTED_MODULE_10__","_mixins_localize_mixin_js__WEBPACK_IMPORTED_MODULE_9__","_polymer_polymer_polymer_element_js__WEBPACK_IMPORTED_MODULE_5__","_createClass","key","value","label","localize","hass","domainFilter","entityFilter","entityIds","keys","states","filter","eid","substr","indexOf","entities","sort","map","state","_common_entity_compute_state_name_js__WEBPACK_IMPORTED_MODULE_8__","a","newVal","this","_hass","opened","ev","stopPropagation","fire","get","_polymer_polymer_lib_utils_html_tag_js__WEBPACK_IMPORTED_MODULE_4__","_templateObject","allowCustomEntity","type","Boolean","observer","_states","Array","computed","autofocus","String","notify","Function","disabled","customElements","define","HaPanelDevState","_mixins_events_mixin_js__WEBPACK_IMPORTED_MODULE_12__","_polymer_polymer_polymer_element_js__WEBPACK_IMPORTED_MODULE_8__","model","entity","_entityId","entity_id","_state","_stateAttributes","JSON","stringify","attributes","preventDefault","entityId","attr","attrRaw","replace","parse","err","alert","callApi","_entityFilter","_stateFilter","_attributeFilter","includes","toLowerCase","attributeFilter","colonIndex","multiMode","keyFilter","valueFilter","substring","trim","attributeKeys","i","length","attributeValue","entityA","entityB","_entities","narrow","_showAttributes","output","isArray","_polymer_polymer_lib_utils_html_tag_js__WEBPACK_IMPORTED_MODULE_7__","showMenu"],"mappings":"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","file":"038663f6fe8c27d70b3b.chunk.js","sourcesContent":["import '@polymer/paper-icon-button/paper-icon-button.js';\nimport '@polymer/paper-input/paper-input.js';\nimport '@polymer/paper-item/paper-icon-item.js';\nimport '@polymer/paper-item/paper-item-body.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\nimport '@vaadin/vaadin-combo-box/vaadin-combo-box-light.js';\n\n\nimport './state-badge.js';\n\nimport computeStateName from '../../common/entity/compute_state_name.js';\nimport LocalizeMixin from '../../mixins/localize-mixin.js';\nimport EventsMixin from '../../mixins/events-mixin.js';\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaEntityPicker extends EventsMixin(LocalizeMixin(PolymerElement)) {\n  static get template() {\n    return html`\n    <style>\n      paper-input > paper-icon-button {\n        width: 24px;\n        height: 24px;\n        padding: 2px;\n        color: var(--secondary-text-color);\n      }\n      [hidden] {\n        display: none;\n      }\n    </style>\n    <vaadin-combo-box-light\n      items=\"[[_states]]\"\n      item-value-path=\"entity_id\"\n      item-label-path=\"entity_id\"\n      value=\"{{value}}\"\n      opened=\"{{opened}}\"\n      allow-custom-value=\"[[allowCustomEntity]]\"\n      on-change='_fireChanged'\n    >\n      <paper-input autofocus=\"[[autofocus]]\" label=\"[[_computeLabel(label, localize)]]\" class=\"input\" value=\"[[value]]\" disabled=\"[[disabled]]\">\n        <paper-icon-button slot=\"suffix\" class=\"clear-button\" icon=\"hass:close\" no-ripple=\"\" hidden$=\"[[!value]]\">Clear</paper-icon-button>\n        <paper-icon-button slot=\"suffix\" class=\"toggle-button\" icon=\"[[_computeToggleIcon(opened)]]\" hidden=\"[[!_states.length]]\">Toggle</paper-icon-button>\n      </paper-input>\n      <template>\n        <style>\n          paper-icon-item {\n            margin: -10px;\n          }\n        </style>\n        <paper-icon-item>\n          <state-badge state-obj=\"[[item]]\" slot=\"item-icon\"></state-badge>\n          <paper-item-body two-line=\"\">\n            <div>[[_computeStateName(item)]]</div>\n            <div secondary=\"\">[[item.entity_id]]</div>\n          </paper-item-body>\n        </paper-icon-item>\n      </template>\n    </vaadin-combo-box-light>\n`;\n  }\n\n  static get properties() {\n    return {\n      allowCustomEntity: {\n        type: Boolean,\n        value: false,\n      },\n      hass: {\n        type: Object,\n        observer: '_hassChanged',\n      },\n      _hass: Object,\n      _states: {\n        type: Array,\n        computed: '_computeStates(_hass, domainFilter, entityFilter)',\n      },\n      autofocus: Boolean,\n      label: {\n        type: String,\n      },\n      value: {\n        type: String,\n        notify: true,\n      },\n      opened: {\n        type: Boolean,\n        value: false,\n        observer: '_openedChanged',\n      },\n      domainFilter: {\n        type: String,\n        value: null,\n      },\n      entityFilter: {\n        type: Function,\n        value: null,\n      },\n      disabled: Boolean,\n    };\n  }\n\n  _computeLabel(label, localize) {\n    return label === undefined\n      ? localize('ui.components.entity.entity-picker.entity')\n      : label;\n  }\n\n  _computeStates(hass, domainFilter, entityFilter) {\n    if (!hass) return [];\n\n    let entityIds = Object.keys(hass.states);\n\n    if (domainFilter) {\n      entityIds = entityIds.filter(eid => eid.substr(0, eid.indexOf('.')) === domainFilter);\n    }\n\n    let entities = entityIds.sort().map(key => hass.states[key]);\n\n    if (entityFilter) {\n      entities = entities.filter(entityFilter);\n    }\n\n    return entities;\n  }\n\n  _computeStateName(state) {\n    return computeStateName(state);\n  }\n\n  _openedChanged(newVal) {\n    if (!newVal) {\n      this._hass = this.hass;\n    }\n  }\n\n  _hassChanged(newVal) {\n    if (!this.opened) {\n      this._hass = newVal;\n    }\n  }\n\n  _computeToggleIcon(opened) {\n    return opened ? 'hass:menu-up' : 'hass:menu-down';\n  }\n\n  _fireChanged(ev) {\n    ev.stopPropagation();\n    this.fire('change');\n  }\n}\n\ncustomElements.define('ha-entity-picker', HaEntityPicker);\n","import '@polymer/app-layout/app-header-layout/app-header-layout.js';\nimport '@polymer/app-layout/app-header/app-header.js';\nimport '@polymer/app-layout/app-toolbar/app-toolbar.js';\nimport '@polymer/paper-button/paper-button.js';\nimport '@polymer/paper-checkbox/paper-checkbox.js';\nimport '@polymer/paper-input/paper-input.js';\nimport '@polymer/paper-input/paper-textarea.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport '../../components/entity/ha-entity-picker.js';\nimport '../../components/ha-menu-button.js';\nimport '../../resources/ha-style.js';\nimport EventsMixin from '../../mixins/events-mixin.js';\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaPanelDevState extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n    <style include=\"ha-style\">\n      :host {\n        -ms-user-select: initial;\n        -webkit-user-select: initial;\n        -moz-user-select: initial;\n      }\n\n      .content {\n        padding: 16px;\n      }\n\n      ha-entity-picker, .state-input, paper-textarea {\n        display: block;\n        max-width: 400px;\n      }\n\n      .entities th {\n        text-align: left;\n      }\n\n      .entities tr {\n        vertical-align: top;\n      }\n\n      .entities tr:nth-child(odd) {\n        background-color: var(--table-row-background-color, #fff)\n      }\n\n      .entities tr:nth-child(even) {\n        background-color: var(--table-row-alternative-background-color, #eee)\n      }\n      .entities td {\n        padding: 4px;\n      }\n      .entities paper-icon-button {\n        height: 24px;\n        padding: 0;\n      }\n      .entities td:nth-child(3) {\n        white-space: pre-wrap;\n        word-break: break-word;\n      }\n\n      .entities a {\n        color: var(--primary-color);\n      }\n    </style>\n\n    <app-header-layout has-scrolling-region>\n      <app-header slot=\"header\" fixed>\n        <app-toolbar>\n          <ha-menu-button narrow='[[narrow]]' show-menu='[[showMenu]]'></ha-menu-button>\n          <div main-title>States</div>\n        </app-toolbar>\n      </app-header>\n\n      <div class='content'>\n        <div>\n          <p>\n            Set the representation of a device within Home Assistant.<br />\n            This will not communicate with the actual device.\n          </p>\n\n          <ha-entity-picker\n            autofocus\n            hass=\"[[hass]]\"\n            value=\"{{_entityId}}\"\n            allow-custom-entity\n          ></ha-entity-picker>\n          <paper-input\n            label=\"State\"\n            required\n            value='{{_state}}'\n            class='state-input'\n          ></paper-input>\n          <paper-textarea label=\"State attributes (JSON, optional)\" value='{{_stateAttributes}}'></paper-textarea>\n          <paper-button on-click='handleSetState' raised>Set State</paper-button>\n        </div>\n\n        <h1>Current entities</h1>\n        <table class='entities'>\n          <tr>\n            <th>Entity</th>\n            <th>State</th>\n            <th hidden$='[[narrow]]'>\n              Attributes\n              <paper-checkbox checked='{{_showAttributes}}'></paper-checkbox>\n            </th>\n          </tr>\n          <tr>\n            <th><paper-input label=\"Filter entities\" type=\"search\" value='{{_entityFilter}}'></paper-input></th>\n            <th><paper-input label=\"Filter states\" type=\"search\" value='{{_stateFilter}}'></paper-input></th>\n            <th hidden$='[[!computeShowAttributes(narrow, _showAttributes)]]'><paper-input label=\"Filter attributes\" type=\"search\" value='{{_attributeFilter}}'></paper-input></th>\n          </tr>\n          <tr hidden$='[[!computeShowEntitiesPlaceholder(_entities)]]'>\n            <td colspan=\"3\">No entities</td>\n          </tr>\n          <template is='dom-repeat' items='[[_entities]]' as='entity'>\n            <tr>\n              <td>\n                <paper-icon-button\n                  on-click='entityMoreInfo'\n                  icon='hass:open-in-new'\n                  alt=\"More Info\" title=\"More Info\"\n                  >\n                </paper-icon-button>\n                <a href='#' on-click='entitySelected'>[[entity.entity_id]]</a>\n              </td>\n              <td>[[entity.state]]</td>\n              <template is='dom-if' if='[[computeShowAttributes(narrow, _showAttributes)]]'>\n                <td>[[attributeString(entity)]]</td>\n              </template>\n            </tr>\n          </template>\n        </table>\n      </div>\n    </app-header-layout>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      narrow: {\n        type: Boolean,\n        value: false,\n      },\n\n      showMenu: {\n        type: Boolean,\n        value: false,\n      },\n\n      _entityId: {\n        type: String,\n        value: '',\n      },\n\n      _entityFilter: {\n        type: String,\n        value: '',\n      },\n\n      _stateFilter: {\n        type: String,\n        value: '',\n      },\n\n      _attributeFilter: {\n        type: String,\n        value: '',\n      },\n\n      _state: {\n        type: String,\n        value: '',\n      },\n\n      _stateAttributes: {\n        type: String,\n        value: '',\n      },\n\n      _showAttributes: {\n        type: Boolean,\n        value: true,\n      },\n\n      _entities: {\n        type: Array,\n        computed: 'computeEntities(hass, _entityFilter, _stateFilter, _attributeFilter)',\n      },\n    };\n  }\n\n  entitySelected(ev) {\n    var state = ev.model.entity;\n    this._entityId = state.entity_id;\n    this._state = state.state;\n    this._stateAttributes = JSON.stringify(state.attributes, null, '  ');\n    ev.preventDefault();\n  }\n\n  entityMoreInfo(ev) {\n    ev.preventDefault();\n    this.fire('hass-more-info', { entityId: ev.model.entity.entity_id });\n  }\n\n  handleSetState() {\n    var attr;\n    var attrRaw = this._stateAttributes.replace(/^\\s+|\\s+$/g, '');\n    try {\n      attr = attrRaw ?\n        JSON.parse(attrRaw) : {};\n    } catch (err) {\n      /* eslint-disable no-alert */\n      alert('Error parsing JSON: ' + err);\n      /* eslint-enable no-alert */\n      return;\n    }\n\n    this.hass.callApi('POST', 'states/' + this._entityId, {\n      state: this._state,\n      attributes: attr,\n    });\n  }\n\n  computeEntities(hass, _entityFilter, _stateFilter, _attributeFilter) {\n    return Object.keys(hass.states).map(function (key) { return hass.states[key]; })\n      .filter(function (value) {\n        if (!value.entity_id.includes(_entityFilter.toLowerCase())) {\n          return false;\n        }\n\n        if (!value.state.includes(_stateFilter.toLowerCase())) {\n          return false;\n        }\n\n        if (_attributeFilter !== '') {\n          var attributeFilter = _attributeFilter.toLowerCase();\n          var colonIndex = attributeFilter.indexOf(':');\n          var multiMode = colonIndex !== -1;\n\n          var keyFilter = attributeFilter;\n          var valueFilter = attributeFilter;\n\n          if (multiMode) {\n            // we need to filter keys and values separately\n            keyFilter = attributeFilter.substring(0, colonIndex).trim();\n            valueFilter = attributeFilter.substring(colonIndex + 1).trim();\n          }\n\n          var attributeKeys = Object.keys(value.attributes);\n\n          for (var i = 0; i < attributeKeys.length; i++) {\n            var key = attributeKeys[i];\n\n            if (key.includes(keyFilter) && !multiMode) {\n              return true; // in single mode we're already satisfied with this match\n            } else if (!key.includes(keyFilter) && multiMode) {\n              continue;\n            }\n\n            var attributeValue = value.attributes[key];\n\n            if (attributeValue !== null\n                && JSON.stringify(attributeValue).toLowerCase().includes(valueFilter)) {\n              return true;\n            }\n          }\n\n          // there are no attributes where the key and/or value can be matched\n          return false;\n        }\n\n        return true;\n      })\n      .sort(function (entityA, entityB) {\n        if (entityA.entity_id < entityB.entity_id) {\n          return -1;\n        }\n        if (entityA.entity_id > entityB.entity_id) {\n          return 1;\n        }\n        return 0;\n      });\n  }\n\n  computeShowEntitiesPlaceholder(_entities) {\n    return _entities.length === 0;\n  }\n\n  computeShowAttributes(narrow, _showAttributes) {\n    return !narrow && _showAttributes;\n  }\n\n  attributeString(entity) {\n    var output = '';\n    var i;\n    var keys;\n    var key;\n    var value;\n\n    for (i = 0, keys = Object.keys(entity.attributes); i < keys.length; i++) {\n      key = keys[i];\n      value = entity.attributes[key];\n      if (!Array.isArray(value) && (value instanceof Object)) {\n        value = JSON.stringify(value, null, '  ');\n      }\n      output += key + ': ' + value + '\\n';\n    }\n\n    return output;\n  }\n}\n\ncustomElements.define('ha-panel-dev-state', HaPanelDevState);\n"],"sourceRoot":""}