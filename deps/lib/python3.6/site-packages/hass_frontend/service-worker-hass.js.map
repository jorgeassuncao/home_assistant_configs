{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/entrypoints/service-worker-hass.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","192","self","addEventListener","message","data","type","skipWaiting","clients","claim","workbox","setConfig","debug","precaching","precacheAndRoute","__precacheManifest","routing","registerRoute","RegExp","location","host","strategies","cacheFirst","networkOnly","staleWhileRevalidate","firePushCallback","payload","jwt","keys","length","constructor","fetch","credentials","method","headers","Headers","Content-Type","Authorization","body","JSON","stringify","notificationEventCallback","eventType","event","action","notification","tag","json","waitUntil","registration","showNotification","title","then","url","close","matchAll","windowClients","client","focus","openWindow"],"mappings":"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","file":"service-worker-hass.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/frontend_latest/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 192);\n","/* global workbox clients */\n\nfunction initRouting() {\n  workbox.precaching.precacheAndRoute(self.__precacheManifest || []);\n\n  // Cache static content (including translations) on first access.\n  workbox.routing.registerRoute(\n    new RegExp(`${location.host}/(static|frontend_latest|frontend_es5)/.+`),\n    workbox.strategies.cacheFirst()\n  );\n\n  // Get api from network.\n  workbox.routing.registerRoute(\n    new RegExp(`${location.host}/api/.*`),\n    workbox.strategies.networkOnly()\n  );\n\n  // Get manifest and service worker from network.\n  workbox.routing.registerRoute(\n    new RegExp(`${location.host}/(service_worker.js|service_worker_es5.js|manifest.json)`),\n    workbox.strategies.networkOnly()\n  );\n\n  // For rest of the files (on Home Assistant domain only) try both cache and network.\n  // This includes the root \"/\" or \"/states\" response and user files from \"/local\".\n  // First access might bring stale data from cache, but a single refresh will bring updated\n  // file.\n  workbox.routing.registerRoute(\n    new RegExp(`${location.host}/.*`),\n    workbox.strategies.staleWhileRevalidate()\n  );\n}\n\nfunction initPushNotifications() {\n  // HTML5 Push Notifications\n  function firePushCallback(payload, jwt) {\n    // Don't send the JWT in the payload.data\n    delete payload.data.jwt;\n    // If payload.data is empty then just remove the entire payload.data object.\n    if (Object.keys(payload.data).length === 0 && payload.data.constructor === Object) {\n      delete payload.data;\n    }\n    fetch('/api/notify.html5/callback', {\n      credentials: 'same-origin',\n      method: 'POST',\n      headers: new Headers({ 'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + jwt }),\n      body: JSON.stringify(payload)\n    });\n  }\n\n  function notificationEventCallback(eventType, event) {\n    firePushCallback({\n      action: event.action,\n      data: event.notification.data,\n      tag: event.notification.tag,\n      type: eventType\n    }, event.notification.data.jwt);\n  }\n\n  self.addEventListener('push', function (event) {\n    var data;\n    if (event.data) {\n      data = event.data.json();\n      event.waitUntil(self.registration.showNotification(data.title, data)\n        .then(function (/* notification */) {\n          firePushCallback({\n            type: 'received',\n            tag: data.tag,\n            data: data.data\n          }, data.data.jwt);\n        }));\n    }\n  });\n\n  self.addEventListener('notificationclick', function (event) {\n    var url;\n\n    notificationEventCallback('clicked', event);\n\n    event.notification.close();\n\n    if (!event.notification.data || !event.notification.data.url) {\n      return;\n    }\n\n    url = event.notification.data.url;\n\n    if (!url) return;\n\n    event.waitUntil(clients.matchAll({\n      type: 'window',\n    })\n      .then(function (windowClients) {\n        var i;\n        var client;\n        for (i = 0; i < windowClients.length; i++) {\n          client = windowClients[i];\n          if (client.url === url && 'focus' in client) {\n            return client.focus();\n          }\n        }\n        if (clients.openWindow) {\n          return clients.openWindow(url);\n        }\n        return undefined;\n      }));\n  });\n\n  self.addEventListener('notificationclose', function (event) {\n    notificationEventCallback('closed', event);\n  });\n}\n\nself.addEventListener('message', (message) => {\n  if (message.data.type === 'skipWaiting') {\n    self.skipWaiting();\n    clients.claim();\n  }\n});\n\nworkbox.setConfig({\n  debug: __DEV__\n});\n\nif (!__DEV__) {\n  initRouting();\n}\n\ninitPushNotifications();\n"],"sourceRoot":""}